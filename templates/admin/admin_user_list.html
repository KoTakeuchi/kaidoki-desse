{% extends "layout-admin.html" %}
{% load static %}

{% block title %}Kaidoki Desse ç®¡ç† | ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§{% endblock %}

{% block admin_content %}
<div class="container-fluid py-4">
  <h2 class="fw-bold mb-4 text-dark">ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†</h2>

  <!-- ======================== -->
  <!-- ğŸ” æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
  <!-- ======================== -->
  <form method="get" class="row g-3 align-items-end mb-4">
    <div class="col-md-6">
      <label class="form-label fw-semibold text-secondary">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢</label>
      <input type="text" name="q" value="{{ query }}" class="form-control" placeholder="ãƒ¦ãƒ¼ã‚¶ãƒ¼åãƒ»ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹">
    </div>
    <div class="col-md-2">
      <button type="submit" class="btn text-white w-100" style="background-color:#3CA9A9;">æ¤œç´¢</button>
    </div>
  </form>

  <!-- ======================== -->
  <!-- ğŸ“‹ ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ -->
  <!-- ======================== -->
  {% if users %}
  <div class="table-responsive">
    <table class="table table-hover align-middle border-top" style="border-color:#b4e4e4;">
      <thead class="table-light">
        <tr class="text-secondary">
          <th>ID</th>
          <th>ãƒ¦ãƒ¼ã‚¶ãƒ¼å</th>
          <th>ãƒ¡ãƒ¼ãƒ«</th>
          <th>å•†å“æ•°</th>
          <th>ç™»éŒ²æ—¥</th>
          <th>æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³</th>
          <th>æ¨©é™</th>
          <th>æ“ä½œ</th>
        </tr>
      </thead>
      <tbody>
        {% for u in users %}
        <tr>
          <td>{{ u.id }}</td>
          <td>{{ u.username }}</td>
          <td>{{ u.email|default:"-" }}</td>
          <td>{{ u.product_count|default:0 }}</td>
          <td>{{ u.date_joined|date:"Y/m/d" }}</td>
          <td>{{ u.last_login|date:"Y/m/d H:i"|default:"-" }}</td>
          <td>
            {% if u.is_superuser %}
              <span class="badge bg-dark rounded-0">ç®¡ç†è€…</span>
            {% elif u.is_staff %}
              <span class="badge bg-secondary rounded-0">ã‚¹ã‚¿ãƒƒãƒ•</span>
            {% else %}
              <span class="badge bg-primary rounded-0" style="background-color:#3CA9A9;">ä¸€èˆ¬</span>
            {% endif %}
          </td>
          <td>
            <button class="btn btn-sm text-white rounded-0"
                    style="background-color:#3CA9A9;"
                    data-bs-toggle="modal"
                    data-bs-target="#userDetailModal{{ u.id }}">
              è©³ç´°
            </button>
          </td>
        </tr>

        <!-- â–¼ ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆè©³ç´°ï¼‰ -->
        <div class="modal fade" id="userDetailModal{{ u.id }}" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content border-0 rounded-0">
              <div class="modal-header" style="background-color:#b4e4e4;">
                <h5 class="modal-title fw-bold text-dark">ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="é–‰ã˜ã‚‹"></button>
              </div>
              <div class="modal-body">
                <table class="table table-borderless mb-0">
                  <tr><th style="width: 25%;" class="text-secondary">ãƒ¦ãƒ¼ã‚¶ãƒ¼å</th><td>{{ u.username }}</td></tr>
                  <tr><th class="text-secondary">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</th><td>{{ u.email|default:"-" }}</td></tr>
                  <tr><th class="text-secondary">ç™»éŒ²æ—¥</th><td>{{ u.date_joined|date:"Y/m/d H:i" }}</td></tr>
                  <tr><th class="text-secondary">æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³</th><td>{{ u.last_login|date:"Y/m/d H:i"|default:"-" }}</td></tr>
                  <tr><th class="text-secondary">æ¨©é™</th>
                    <td>
                      {% if u.is_superuser %}ç®¡ç†è€…{% elif u.is_staff %}ã‚¹ã‚¿ãƒƒãƒ•{% else %}ä¸€èˆ¬{% endif %}
                    </td>
                  </tr>
                  <tr><th class="text-secondary">ç™»éŒ²å•†å“æ•°</th><td>{{ u.product_count }}</td></tr>
                </table>
              </div>
              <div class="modal-footer bg-light">
                <button type="button" class="btn btn-outline-dark rounded-0" data-bs-dismiss="modal">é–‰ã˜ã‚‹</button>
              </div>
            </div>
          </div>
        </div>
        {% endfor %}
      </tbody>
    </table>
  </div>
  {% else %}
  <p class="text-muted mt-3">ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã¯ã¾ã ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚</p>
  {% endif %}
</div>
{% endblock %}
