{% extends "layout-user.html" %}
{% block title %}è²·ã„æ™‚é€šçŸ¥ä¸€è¦§{% endblock %}

{% block page_content %}
<!-- âœ… AUTHæº–æ‹ ã‚¿ã‚¤ãƒˆãƒ«æ§‹é€  -->
<div class="page-header">
  <h1 class="page-title">
    <span class="title-inner">è²·ã„æ™‚é€šçŸ¥ä¸€è¦§</span>
  </h1>
</div>

<div class="container py-4">
  <div class="card shadow-sm p-4">

    <!-- âœ… ãƒ•ã‚£ãƒ«ã‚¿ãƒ»ã‚½ãƒ¼ãƒˆ -->
    <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap">
      <h5 class="mb-2 mb-md-0">ğŸ”” è²·ã„æ™‚é€šçŸ¥ä¸€è¦§</h5>

      <form method="get" class="d-flex gap-2 flex-wrap">
        <select name="filter" class="form-select form-select-sm" onchange="this.form.submit()">
          <option value="all" {% if filter_type == "all" %}selected{% endif %}>ã™ã¹ã¦</option>
          <option value="unread" {% if filter_type == "unread" %}selected{% endif %}>æœªèª­ã®ã¿</option>
          <option value="read" {% if filter_type == "read" %}selected{% endif %}>æ—¢èª­ã®ã¿</option>
        </select>

        <select name="sort" class="form-select form-select-sm" onchange="this.form.submit()">
          <option value="desc" {% if sort_order == "desc" %}selected{% endif %}>æ–°ã—ã„é †</option>
          <option value="asc" {% if sort_order == "asc" %}selected{% endif %}>å¤ã„é †</option>
        </select>
      </form>
    </div>

    <!-- âœ… é€šçŸ¥ä¸€è¦§ -->
    {% if notifications %}
      <ul class="list-group">
        {% for n in notifications %}
          <li class="list-group-item d-flex justify-content-between align-items-center flex-wrap
                     {% if not n.is_read %}bg-light border-start border-4 border-danger{% endif %}">
            <div>
              <strong>{{ n.product_name }}</strong>
              {% if n.type == "åœ¨åº«å¾©æ´»é€šçŸ¥" %}
                <span class="badge bg-success ms-2">ğŸ“¦ åœ¨åº«å¾©æ´»</span>
              {% elif n.type == "åœ¨åº«å°‘é€šçŸ¥" %}
                <span class="badge bg-warning text-dark ms-2">âš  åœ¨åº«å°‘</span>
              {% elif n.type == "è²·ã„æ™‚ä¾¡æ ¼ãƒ’ãƒƒãƒˆ" %}
                <span class="badge bg-primary ms-2">ğŸ’° è²·ã„æ™‚</span>
              {% elif n.type == "éå»æœ€å®‰å€¤ã‚’æ›´æ–°" %}
                <span class="badge bg-info text-dark ms-2">ğŸ“‰ æœ€å®‰å€¤</span>
              {% elif n.type == "å‰²å¼•ç‡æŒ‡å®šä»¥ä¸Š" %}
                <span class="badge bg-secondary ms-2">ğŸ¯ å‰²å¼•</span>
              {% endif %}
              {% if not n.is_read %}
                <span class="badge bg-danger ms-2">æœªèª­</span>
              {% endif %}
              <br>
              <small class="text-muted">{{ n.message }}</small>
            </div>

            <div class="d-flex align-items-center gap-2 mt-2 mt-md-0">
              <small class="text-secondary me-2">{{ n.created_at|date:"Y-m-d H:i" }}</small>
              <a href="{% url 'main:mark_notification_read' n.id %}" class="btn btn-sm btn-outline-primary">
                âœ… æ—¢èª­
              </a>
            </div>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="text-muted text-center mt-3">è©²å½“ã™ã‚‹é€šçŸ¥ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    {% endif %}

    <!-- âœ… æˆ»ã‚‹ãƒœã‚¿ãƒ³ -->
    <div class="text-center mt-4">
      <a href="{% url 'main:product_list' %}" class="btn btn-outline-secondary">å•†å“ä¸€è¦§ã«æˆ»ã‚‹</a>
    </div>

  </div>
</div>
{% endblock %}
