{% extends "base.html" %}
{% load static %}
{% block title %}è²·ã„æ™‚ã§ã£ã›ï½œãƒã‚¤ãƒšãƒ¼ã‚¸{% endblock %}

{% block extra_css %}
<!-- å…±é€šCSS -->
<link rel="stylesheet" href="{% static 'css/app.css' %}?v={{ STATIC_VERSION }}">
<!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼UIå°‚ç”¨CSSï¼ˆä¸Šæ›¸ãå„ªå…ˆï¼‰ -->
<link rel="stylesheet" href="{% static 'css/user.css' %}?v={{ STATIC_VERSION }}">

<style>
  /* ğŸ”” æœªèª­é€šçŸ¥ãƒãƒƒã‚¸ */
  .notif-badge {
    position: absolute;
    top: 0;
    right: -6px;
    background: #dc3545;
    color: white;
    font-size: 0.75rem;
    font-weight: bold;
    padding: 0 6px;
    border-radius: 50%;
    display: none;
    transform: translate(25%, -25%);
  }

  .notif-badge.active {
    display: inline-block;
  }
</style>
{% endblock %}

{% block body_open %}
<body class="{% block body_class %}{% endblock %}">
{% endblock %}

{% block header %}
<header class="header-bar">
  <div class="header-inner px-3">
    <!-- ğŸ”¹ å·¦å´ï¼šã‚¢ã‚¤ã‚³ãƒ³ï¼‹ã‚¿ã‚¤ãƒˆãƒ« -->
    <a class="header-brand" href="{% url 'main:product_list' %}">
      <div class="header-icon-wrapper">
        <img src="{% static 'images/icon_kaidoki.svg' %}" alt="è²·ã„æ™‚ã§ã£ã›">
      </div>
      <span class="header-title">è²·ã„æ™‚ã§ã£ã›</span>
    </a>

    <!-- ğŸ”¹ å³å´ï¼šãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
    <div class="header-actions">
      <ul class="navbar-nav ms-auto d-flex align-items-center flex-row gap-4 mb-0">

        <!-- å•†å“ -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-white fw-bold" href="#" data-bs-toggle="dropdown">
            <img src="{% static 'images/icon_product.png' %}" alt="å•†å“" class="nav-icon me-2">å•†å“
          </a>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="{% url 'main:product_create' %}">å•†å“ç™»éŒ²</a></li>
            <li><a class="dropdown-item" href="{% url 'main:product_list' %}">å•†å“ä¸€è¦§</a></li>
            <li><a class="dropdown-item" href="{% url 'main:category_my' %}">ã‚«ãƒ†ã‚´ãƒªç®¡ç†</a></li>
          </ul>
        </li>

        <!-- é€šçŸ¥ -->
        <li class="nav-item dropdown position-relative">
          <a class="nav-link dropdown-toggle text-white fw-bold" href="#" data-bs-toggle="dropdown">
            <img src="{% static 'images/icon_notification.png' %}" alt="é€šçŸ¥" class="nav-icon-small me-2">
            é€šçŸ¥
            <!-- ğŸ”” æœªèª­ä»¶æ•°ãƒãƒƒã‚¸ -->
            <span id="unread-badge"
              class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
              style="font-size: 0.75rem; display: none;">
              0
            </span>
          </a>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="{% url 'main:notifications' %}">é€šçŸ¥ä¸€è¦§</a></li>
            <li><a class="dropdown-item" href="{% url 'main:flag_setting' %}">é€šçŸ¥è¨­å®š</a></li>
          </ul>
        </li>

        <!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle text-white fw-bold" href="#" data-bs-toggle="dropdown">
            <img src="{% static 'images/icon_user.png' %}" alt="ãƒ¦ãƒ¼ã‚¶ãƒ¼" class="nav-icon me-2">
            {{ user.username }} ã•ã‚“
          </a>
          <ul class="dropdown-menu dropdown-menu-end">
            <li><a class="dropdown-item" href="{% url 'main:user_edit' %}">ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·¨é›†</a></li>
            <li>
              <form method="post" action="{% url 'logout' %}" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="dropdown-item text-danger"
                  style="background:none; border:none; width:100%; text-align:left;">
                  ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
                </button>
              </form>
            </li>
          </ul>
        </li>
      </ul>
    </div>
  </div>
</header>
{% endblock %}

{% block page_content %}
<div class="container py-4">
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'js/header_notifications.js' %}?v={{ STATIC_VERSION }}"></script>
<script src="{% static 'js/unread_badge.js' %}?v={{ STATIC_VERSION }}"></script>
<script src="{% static 'js/notification_read.js' %}?v={{ STATIC_VERSION }}"></script>
<script src="{% static 'js/toggle_password.js' %}?v={{ STATIC_VERSION }}"></script>

{% endblock %}
